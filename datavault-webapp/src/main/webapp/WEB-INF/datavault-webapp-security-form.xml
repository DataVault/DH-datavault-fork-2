<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	   		http://www.springframework.org/schema/beans/spring-beans.xsd
			http://www.springframework.org/schema/security 
			http://www.springframework.org/schema/security/spring-security.xsd">
	
    <security:http pattern="/resources/**" security="none"/>

	<security:http>

        <security:intercept-url pattern="/auth/**" access="permitAll" />
        <security:intercept-url pattern="/**" access="hasRole('ROLE_USER')" />

        <security:access-denied-handler error-page="/auth/denied"/>

        <security:form-login
            login-page="/auth/login"
            login-processing-url="/auth/security_check"
            authentication-failure-url="/auth/login?error=true"
            default-target-url="/"/>

        <security:logout
                logout-url="/auth/logout"
                logout-success-url="/auth/login?logout"/>

	</security:http>
	
    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service>
                <security:user name="USER1" password="password1" authorities="ROLE_USER" />
                <security:user name="USER2" password="password2" authorities="ROLE_USER" />
                <security:user name="USER3" password="password3" authorities="ROLE_USER" />
                <security:user name="USER4" password="password4" authorities="ROLE_USER" />
                <security:user name="USER5" password="password5" authorities="ROLE_USER" />
                <security:user name="USER6" password="password6" authorities="ROLE_USER" />
                <security:user name="USER7" password="password7" authorities="ROLE_USER" />
                <security:user name="USER8" password="password8" authorities="ROLE_USER" />
                <security:user name="USER9" password="password9" authorities="ROLE_USER" />
                <security:user name="USER10" password="password10" authorities="ROLE_USER" />
                <security:user name="USER11" password="password11" authorities="ROLE_USER" />
                <security:user name="USER12" password="password12" authorities="ROLE_USER" />
                <security:user name="USER13" password="password13" authorities="ROLE_USER" />
                <security:user name="USER14" password="password14" authorities="ROLE_USER" />
                <security:user name="USER15" password="password15" authorities="ROLE_USER" />
                <security:user name="USER16" password="password16" authorities="ROLE_USER" />
                <security:user name="USER17" password="password17" authorities="ROLE_USER" />
                <security:user name="USER18" password="password18" authorities="ROLE_USER" />
                <security:user name="USER19" password="password19" authorities="ROLE_USER" />
                <security:user name="USER20" password="password20" authorities="ROLE_USER" />
                <security:user name="USER21" password="password21" authorities="ROLE_USER" />
                <security:user name="USER22" password="password22" authorities="ROLE_USER" />
                <security:user name="USER23" password="password23" authorities="ROLE_USER" />
                <security:user name="USER24" password="password24" authorities="ROLE_USER" />
                <security:user name="USER25" password="password25" authorities="ROLE_USER" />
                <security:user name="USER26" password="password26" authorities="ROLE_USER" />
                <security:user name="USER27" password="password27" authorities="ROLE_USER" />
                <security:user name="USER28" password="password28" authorities="ROLE_USER" />
                <security:user name="USER29" password="password29" authorities="ROLE_USER" />
                <security:user name="USER30" password="password30" authorities="ROLE_USER" />
            </security:user-service>
        </security:authentication-provider>

        <!--<security:authentication-provider ref="databaseAuthenticationProvider"/> -->
	</security:authentication-manager>

    <bean id="databaseAuthenticationProvider" class="org.datavaultplatform.webapp.authentication.DatabaseAuthenticationProvider">
        <property name="restService" ref="restService" />
    </bean>

</beans>
